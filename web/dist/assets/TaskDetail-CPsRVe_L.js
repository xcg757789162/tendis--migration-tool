import{_ as te,o as le,a as ae,b as u,c,d as e,e as l,w as a,f as _,t as n,h as S,g as $,F as q,p as f,n as oe,r as W,i as C,k,j as r,E as m,v as O,q as H,y as ne,x as ie}from"./index-C5Ql7TWZ.js";const re={key:0,class:"task-detail"},ue={class:"page-header"},de={class:"header-left"},ce={class:"title-section"},_e={class:"task-id-row"},pe={class:"header-actions"},ve={key:0,class:"progress-overview card"},me={class:"overview-header"},fe={class:"header-right"},ge={class:"phase-tag"},ye={class:"big-progress"},ke={class:"progress-circle"},be={viewBox:"0 0 100 100"},he={class:"progress-text"},we={class:"percent"},Ce={class:"progress-stats"},xe={class:"stat-row"},Ve={class:"stat-item"},Te={class:"value stat-number"},De={class:"stat-item"},Le={class:"value"},Re={class:"stat-item"},Se={class:"value filtered"},Fe={class:"stat-row"},Ke={class:"stat-item"},qe={class:"value"},ze={class:"stat-item"},Ee={class:"value"},Be={class:"stat-row"},Ie={class:"stat-item"},Ue={class:"value highlight"},Ne={class:"stat-item"},Pe={class:"value"},Oe={class:"stat-item"},je={class:"value elapsed"},Me={class:"info-grid"},Ye={class:"info-card card"},$e={class:"cluster-info"},We={class:"info-card card"},He={class:"cluster-info"},Ae={class:"info-card card config-card"},Je={class:"config-header"},Qe={class:"config-info"},Ge={class:"config-row"},Xe={class:"value highlight"},Ze={class:"config-row"},st={class:"value"},et={class:"config-row"},tt={class:"value"},lt={class:"config-row"},at={class:"value"},ot={class:"config-row"},nt={class:"value"},it={class:"config-row"},rt={class:"value"},ut={class:"config-row"},dt={class:"value"},ct={class:"config-row"},_t={class:"value"},pt={class:"info-card card"},vt={class:"config-info"},mt={class:"config-row"},ft={class:"value"},gt={key:0,class:"config-row"},yt={class:"value"},kt={key:1,class:"config-row"},bt={class:"value"},ht={key:2,class:"config-row"},wt={class:"value"},Ct={key:3,class:"config-row"},xt={class:"value"},Vt={key:1,class:"verify-section card"},Tt={class:"mono"},Dt={key:2,class:"error-keys-section card"},Lt={class:"section-header"},Rt={class:"error-stats"},St={class:"stat-item"},Ft={class:"stat-value error"},Kt={class:"stat-item"},qt={class:"stat-value warning"},zt={class:"stat-item"},Et={class:"stat-value info"},Bt={class:"stat-item"},It={class:"stat-value"},Ut={key:0,class:"error-keys-list"},Nt={class:"mono"},Pt={key:0,class:"list-footer"},Ot={key:1,class:"no-errors"},jt={class:"task-logs card"},Mt={class:"logs-header"},Yt={class:"logs-actions"},$t={key:0,class:"no-logs"},Wt={class:"log-time"},Ht={class:"log-message"},At={key:0,class:"log-fields"},Jt={key:1,class:"loading"},Qt={__name:"TaskDetail",setup(Gt){const Cs=ie(),b=O(()=>Cs.params.id),i=k(null),g=k(null),z=k([]),E=k([]),B=k(""),xs=k(null),L=k(1e4),j=k(!1),h=k({total:0,failed:0,skipped:0,large_keys:0}),R=k([]);let D=null;const F=k(!1),M=k(!1),p=ne({worker_count:8,scan_batch_size:1e3,source_qps:0,target_qps:0}),Vs=O(()=>{var t;if(!((t=i.value)!=null&&t.source_cluster))return{};if(typeof i.value.source_cluster=="object")return i.value.source_cluster;try{return JSON.parse(i.value.source_cluster)}catch{return typeof i.value.source_cluster=="string"?{addrs:i.value.source_cluster.split(",").map(s=>s.trim()).filter(s=>s)}:{}}}),Ts=O(()=>{var t;if(!((t=i.value)!=null&&t.target_cluster))return{};if(typeof i.value.target_cluster=="object")return i.value.target_cluster;try{return JSON.parse(i.value.target_cluster)}catch{return typeof i.value.target_cluster=="string"?{addrs:i.value.target_cluster.split(",").map(s=>s.trim()).filter(s=>s)}:{}}}),x=O(()=>{var t;try{return JSON.parse(((t=i.value)==null?void 0:t.config)||"{}")}catch{return{}}}),V=async()=>{try{j.value=!0;const t=await C.getTask(b.value);i.value=t,g.value=t.progress}catch(t){console.error("Fetch task failed:",t)}finally{j.value=!1}},Ds=()=>{D&&(clearInterval(D),D=null),L.value>0&&(D=setInterval(()=>{var t;((t=i.value)==null?void 0:t.status)==="running"&&(V(),I())},L.value))},A=async()=>{try{const t=await C.getVerifyResults(b.value);z.value=t||[]}catch{z.value=[]}},J=async()=>{try{const t=await C.getErrorKeys(b.value);h.value=(t==null?void 0:t.stats)||{total:0,failed:0,skipped:0,large_keys:0},R.value=(t==null?void 0:t.items)||[]}catch{h.value={total:0,failed:0,skipped:0,large_keys:0},R.value=[]}},Q=async()=>{try{const t=await C.downloadErrorKeys(b.value),s=window.URL.createObjectURL(t),v=document.createElement("a");v.href=s,v.download=`error-keys-${b.value.substring(0,8)}-${H().format("YYYYMMDDHHmmss")}.csv`,document.body.appendChild(v),v.click(),window.URL.revokeObjectURL(s),document.body.removeChild(v),m.success("下载成功")}catch(t){m.error("下载失败: "+(t.message||"未知错误"))}},Ls=t=>({failed:"danger",skipped:"warning",large_key:"info",timeout:"danger",conflict:"warning"})[t]||"info",Rs=t=>({failed:"迁移失败",skipped:"冲突跳过",large_key:"大Key",timeout:"超时",conflict:"键冲突"})[t]||t,I=async()=>{try{const t={limit:100};B.value&&(t.level=B.value);const s=await C.getTaskLogs(b.value,t);E.value=(s==null?void 0:s.items)||[]}catch(t){console.error("Fetch task logs failed:",t),E.value=[]}},G=t=>H(t).format("HH:mm:ss.SSS"),Ss=t=>{if(!t||typeof t!="object")return"";const s=Object.entries(t);return s.length===0?"":s.map(([v,d])=>`${v}=${JSON.stringify(d)}`).join(" ")},Fs=async()=>{try{await C.startTask(b.value),m.success("任务已启动"),V()}catch{m.error("启动失败")}},Ks=async()=>{try{await C.pauseTask(b.value),m.success("任务已暂停"),V()}catch{m.error("暂停失败")}},qs=async()=>{try{await C.resumeTask(b.value),m.success("任务已恢复"),V()}catch{m.error("恢复失败")}},zs=async()=>{try{await C.triggerVerify(b.value),m.success("校验任务已触发"),setTimeout(A,3e3)}catch{m.error("触发校验失败")}},Es=t=>{if(navigator.clipboard&&window.isSecureContext)return navigator.clipboard.writeText(t);const s=document.createElement("textarea");s.value=t,s.style.position="fixed",s.style.left="-9999px",document.body.appendChild(s),s.select();try{return document.execCommand("copy"),Promise.resolve()}catch(v){return Promise.reject(v)}finally{document.body.removeChild(s)}},X=async()=>{try{await Es(i.value.id),m.success("任务ID已复制")}catch{m.error("复制失败")}},Bs=t=>({pending:"待启动",running:"运行中",paused:"已暂停",completed:"已完成",failed:"失败"})[t]||t,Is=t=>({skip:"跳过已存在",replace:"覆盖",error:"报错",skip_full_only:"仅全量跳过"})[t]||t||"skip",Us=()=>{var s,v;const t=x.value||{};p.worker_count=t.worker_count||8,p.scan_batch_size=t.scan_batch_size||1e3,p.source_qps=((s=t.rate_limit)==null?void 0:s.source_qps)||0,p.target_qps=((v=t.rate_limit)==null?void 0:v.target_qps)||0,F.value=!0},Ns=async()=>{M.value=!0;try{await C.updateTaskConfig(b.value,{worker_count:p.worker_count,scan_batch_size:p.scan_batch_size,rate_limit:{source_qps:p.source_qps,target_qps:p.target_qps}}),m.success("参数调整已提交，将在当前批次完成后生效"),F.value=!1,setTimeout(V,2e3)}catch(t){m.error("参数调整失败: "+(t.message||"未知错误"))}finally{M.value=!1}},Ps=t=>({full:"全量迁移",incremental:"增量同步",verify:"数据校验"})[t]||t,U=t=>t>=1e9?(t/1e9).toFixed(1)+"B":t>=1e6?(t/1e6).toFixed(1)+"M":t>=1e3?(t/1e3).toFixed(1)+"K":t.toString(),Y=t=>t>=1099511627776?(t/1099511627776).toFixed(2)+" TB":t>=1073741824?(t/1073741824).toFixed(2)+" GB":t>=1048576?(t/1048576).toFixed(2)+" MB":t>=1024?(t/1024).toFixed(2)+" KB":t+" B",Z=t=>H(t).format("YYYY-MM-DD HH:mm:ss");return le(()=>{V(),A(),I(),J(),L.value>0&&(D=setInterval(()=>{var t;((t=i.value)==null?void 0:t.status)==="running"&&(V(),I(),J())},L.value))}),ae(()=>{D&&clearInterval(D)}),(t,s)=>{var is,rs,us,ds,cs,_s,ps,vs,ms,fs,gs,ys,ks,bs,hs;const v=r("ArrowLeft"),d=r("el-icon"),y=r("el-button"),Os=r("el-tooltip"),js=r("CopyDocument"),ss=r("VideoPlay"),Ms=r("VideoPause"),es=r("Checked"),T=r("el-option"),ts=r("el-select"),ls=r("Refresh"),as=r("Connection"),os=r("Link"),Ys=r("Setting"),$s=r("Edit"),Ws=r("Clock"),w=r("el-table-column"),ns=r("el-table"),Hs=r("Warning"),As=r("Download"),Js=r("el-tag"),Qs=r("SuccessFilled"),Gs=r("Document"),Xs=r("Loading"),Zs=r("el-alert"),N=r("el-input-number"),P=r("el-form-item"),se=r("el-form"),ee=r("el-dialog");return u(),c(q,null,[i.value?(u(),c("div",re,[e("div",ue,[e("div",de,[l(y,{text:"",onClick:s[0]||(s[0]=o=>t.$router.push("/tasks"))},{default:a(()=>[l(d,null,{default:a(()=>[l(v)]),_:1}),s[9]||(s[9]=_(" 返回列表 ",-1))]),_:1}),e("div",ce,[e("h1",null,n(i.value.name),1),e("div",_e,[s[10]||(s[10]=e("span",{class:"task-id-label"},"ID:",-1)),l(Os,{content:"点击复制",placement:"top"},{default:a(()=>[e("span",{class:"task-id",onClick:X},n(i.value.id),1)]),_:1}),l(d,{class:"copy-icon",onClick:X},{default:a(()=>[l(js)]),_:1})])]),e("span",{class:S(["status-tag",i.value.status])},n(Bs(i.value.status)),3)]),e("div",pe,[i.value.status==="pending"?(u(),$(y,{key:0,type:"primary",onClick:Fs},{default:a(()=>[l(d,null,{default:a(()=>[l(ss)]),_:1}),s[11]||(s[11]=_(" 启动任务 ",-1))]),_:1})):i.value.status==="running"?(u(),c(q,{key:1},[l(y,{onClick:Ks},{default:a(()=>[l(d,null,{default:a(()=>[l(Ms)]),_:1}),s[12]||(s[12]=_(" 暂停 ",-1))]),_:1}),l(y,{type:"primary",onClick:zs},{default:a(()=>[l(d,null,{default:a(()=>[l(es)]),_:1}),s[13]||(s[13]=_(" 校验 ",-1))]),_:1})],64)):i.value.status==="paused"?(u(),$(y,{key:2,type:"primary",onClick:qs},{default:a(()=>[l(d,null,{default:a(()=>[l(ss)]),_:1}),s[14]||(s[14]=_(" 恢复 ",-1))]),_:1})):f("",!0)])]),g.value?(u(),c("div",ve,[e("div",me,[s[16]||(s[16]=e("h2",null,"迁移进度",-1)),e("div",fe,[l(ts,{modelValue:L.value,"onUpdate:modelValue":s[1]||(s[1]=o=>L.value=o),size:"small",style:{width:"120px"},onChange:Ds},{default:a(()=>[l(T,{label:"手动刷新",value:0}),l(T,{label:"每 10 秒",value:1e4}),l(T,{label:"每 30 秒",value:3e4}),l(T,{label:"每 1 分钟",value:6e4})]),_:1},8,["modelValue"]),l(y,{size:"small",onClick:V,loading:j.value},{default:a(()=>[l(d,null,{default:a(()=>[l(ls)]),_:1}),s[15]||(s[15]=_(" 刷新 ",-1))]),_:1},8,["loading"]),e("span",ge,n(Ps(g.value.phase)),1)])]),e("div",ye,[e("div",ke,[(u(),c("svg",be,[s[17]||(s[17]=e("circle",{class:"bg",cx:"50",cy:"50",r:"45"},null,-1)),e("circle",{class:"progress",cx:"50",cy:"50",r:"45",style:oe({strokeDasharray:`${g.value.percentage*2.83} 283`})},null,4)])),e("div",he,[e("span",we,n(((is=g.value.percentage)==null?void 0:is.toFixed(1))||0),1),s[18]||(s[18]=e("span",{class:"unit"},"%",-1))])]),e("div",Ce,[e("div",xe,[e("div",Ve,[s[19]||(s[19]=e("span",{class:"label"},"已迁移Key",-1)),e("span",Te,n(U(g.value.migrated_keys||0)),1)]),e("div",De,[s[20]||(s[20]=e("span",{class:"label"},"总Key数",-1)),e("span",Le,n(U(g.value.total_keys||0)),1)]),e("div",Re,[s[21]||(s[21]=e("span",{class:"label"},"过滤Key",-1)),e("span",Se,n(U(i.value.keys_filtered||0)),1)])]),e("div",Fe,[e("div",Ke,[s[22]||(s[22]=e("span",{class:"label"},"已迁移数据",-1)),e("span",qe,n(Y(g.value.migrated_bytes||0)),1)]),e("div",ze,[s[23]||(s[23]=e("span",{class:"label"},"总数据量",-1)),e("span",Ee,n(Y(g.value.total_bytes||0)),1)])]),e("div",Be,[e("div",Ie,[s[24]||(s[24]=e("span",{class:"label"},"当前速度",-1)),e("span",Ue,n(U(g.value.current_speed||0))+" keys/s",1)]),e("div",Ne,[s[25]||(s[25]=e("span",{class:"label"},"预计剩余时间",-1)),e("span",Pe,n(g.value.estimated_eta||"-"),1)]),e("div",Oe,[s[26]||(s[26]=e("span",{class:"label"},"已耗时间",-1)),e("span",je,n(g.value.elapsed_time||"-"),1)])])])])])):f("",!0),e("div",Me,[e("div",Ye,[e("h3",null,[l(d,null,{default:a(()=>[l(as)]),_:1}),s[27]||(s[27]=_(" 源集群",-1))]),e("div",$e,[(u(!0),c(q,null,W(((rs=Vs.value)==null?void 0:rs.addrs)||[],o=>(u(),c("div",{class:"info-row",key:o},[l(d,null,{default:a(()=>[l(os)]),_:1}),e("span",null,n(o),1)]))),128))])]),e("div",We,[e("h3",null,[l(d,null,{default:a(()=>[l(as)]),_:1}),s[28]||(s[28]=_(" 目标集群",-1))]),e("div",He,[(u(!0),c(q,null,W(((us=Ts.value)==null?void 0:us.addrs)||[],o=>(u(),c("div",{class:"info-row",key:o},[l(d,null,{default:a(()=>[l(os)]),_:1}),e("span",null,n(o),1)]))),128))])]),e("div",Ae,[e("div",Je,[e("h3",null,[l(d,null,{default:a(()=>[l(Ys)]),_:1}),s[29]||(s[29]=_(" 运行参数",-1))]),i.value.status==="running"?(u(),$(y,{key:0,type:"primary",size:"small",text:"",onClick:Us},{default:a(()=>[l(d,null,{default:a(()=>[l($s)]),_:1}),s[30]||(s[30]=_(" 调整参数 ",-1))]),_:1})):f("",!0)]),e("div",Qe,[e("div",Ge,[s[31]||(s[31]=e("span",{class:"label"},"Worker数量",-1)),e("span",Xe,n(((ds=x.value)==null?void 0:ds.worker_count)||4),1)]),e("div",Ze,[s[32]||(s[32]=e("span",{class:"label"},"扫描批次大小",-1)),e("span",st,n(((cs=x.value)==null?void 0:cs.scan_batch_size)||1e3),1)]),e("div",et,[s[33]||(s[33]=e("span",{class:"label"},"源端QPS限制",-1)),e("span",tt,n(((ps=(_s=x.value)==null?void 0:_s.rate_limit)==null?void 0:ps.source_qps)||"不限制"),1)]),e("div",lt,[s[34]||(s[34]=e("span",{class:"label"},"目标端QPS限制",-1)),e("span",at,n(((ms=(vs=x.value)==null?void 0:vs.rate_limit)==null?void 0:ms.target_qps)||"不限制"),1)]),e("div",ot,[s[35]||(s[35]=e("span",{class:"label"},"源端连接数",-1)),e("span",nt,n(((gs=(fs=x.value)==null?void 0:fs.rate_limit)==null?void 0:gs.source_connections)||50),1)]),e("div",it,[s[36]||(s[36]=e("span",{class:"label"},"目标端连接数",-1)),e("span",rt,n(((ks=(ys=x.value)==null?void 0:ys.rate_limit)==null?void 0:ks.target_connections)||50),1)]),e("div",ut,[s[37]||(s[37]=e("span",{class:"label"},"冲突策略",-1)),e("span",dt,n(Is((bs=x.value)==null?void 0:bs.conflict_policy)),1)]),e("div",ct,[s[38]||(s[38]=e("span",{class:"label"},"大Key阈值",-1)),e("span",_t,n(Y(((hs=x.value)==null?void 0:hs.large_key_threshold)||10485760)),1)])])]),e("div",pt,[e("h3",null,[l(d,null,{default:a(()=>[l(Ws)]),_:1}),s[39]||(s[39]=_(" 时间信息",-1))]),e("div",vt,[e("div",mt,[s[40]||(s[40]=e("span",{class:"label"},"创建时间",-1)),e("span",ft,n(Z(i.value.created_at)),1)]),i.value.started_at?(u(),c("div",gt,[s[41]||(s[41]=e("span",{class:"label"},"启动时间",-1)),e("span",yt,n(i.value.started_at),1)])):f("",!0),i.value.full_start_at?(u(),c("div",kt,[s[42]||(s[42]=e("span",{class:"label"},"全量开始",-1)),e("span",bt,n(i.value.full_start_at),1)])):f("",!0),i.value.incr_start_at?(u(),c("div",ht,[s[43]||(s[43]=e("span",{class:"label"},"增量开始",-1)),e("span",wt,n(i.value.incr_start_at),1)])):f("",!0),i.value.completed_at?(u(),c("div",Ct,[s[44]||(s[44]=e("span",{class:"label"},"完成时间",-1)),e("span",xt,n(Z(i.value.completed_at)),1)])):f("",!0)])])]),z.value.length?(u(),c("div",Vt,[e("h3",null,[l(d,null,{default:a(()=>[l(es)]),_:1}),s[45]||(s[45]=_(" 校验结果",-1))]),l(ns,{data:z.value,style:{width:"100%"}},{default:a(()=>[l(w,{label:"批次ID",width:"200"},{default:a(({row:o})=>[e("span",Tt,n(o.batch_id.slice(0,8))+"...",1)]),_:1}),l(w,{label:"采样Key数",prop:"total_keys",width:"120"}),l(w,{label:"匹配数",prop:"matched_keys",width:"100"}),l(w,{label:"不一致",width:"100"},{default:a(({row:o})=>[e("span",{class:S({"error-text":o.mismatched_keys>0})},n(o.mismatched_keys),3)]),_:1}),l(w,{label:"缺失Key",width:"100"},{default:a(({row:o})=>[e("span",{class:S({"error-text":o.missing_keys>0})},n(o.missing_keys),3)]),_:1}),l(w,{label:"一致性"},{default:a(({row:o})=>{var K;return[e("span",{class:S(["consistency-rate",{high:o.consistency_rate>=99.9}])},n(((K=o.consistency_rate)==null?void 0:K.toFixed(2))||0)+"% ",3)]}),_:1})]),_:1},8,["data"])])):f("",!0),i.value.status==="completed"||i.value.status==="failed"||h.value.total>0?(u(),c("div",Dt,[e("div",Lt,[e("h3",null,[l(d,null,{default:a(()=>[l(Hs)]),_:1}),s[46]||(s[46]=_(" 异常/跳过Key统计",-1))]),l(y,{type:"primary",size:"small",onClick:Q,disabled:h.value.total===0},{default:a(()=>[l(d,null,{default:a(()=>[l(As)]),_:1}),s[47]||(s[47]=_(" 下载详情 ",-1))]),_:1},8,["disabled"])]),e("div",Rt,[e("div",St,[e("span",Ft,n(h.value.failed||0),1),s[48]||(s[48]=e("span",{class:"stat-label"},"迁移失败",-1))]),e("div",Kt,[e("span",qt,n(h.value.skipped||0),1),s[49]||(s[49]=e("span",{class:"stat-label"},"冲突跳过",-1))]),e("div",zt,[e("span",Et,n(h.value.large_keys||0),1),s[50]||(s[50]=e("span",{class:"stat-label"},"大Key处理",-1))]),e("div",Bt,[e("span",It,n(h.value.total||0),1),s[51]||(s[51]=e("span",{class:"stat-label"},"异常总数",-1))])]),R.value.length>0?(u(),c("div",Ut,[l(ns,{data:R.value,style:{width:"100%"},"max-height":"300"},{default:a(()=>[l(w,{label:"Key名称","min-width":"200"},{default:a(({row:o})=>[e("span",Nt,n(o.key),1)]),_:1}),l(w,{label:"类型",width:"100",prop:"type"}),l(w,{label:"原因",width:"120"},{default:a(({row:o})=>[l(Js,{type:Ls(o.reason),size:"small"},{default:a(()=>[_(n(Rs(o.reason)),1)]),_:2},1032,["type"])]),_:1}),l(w,{label:"详情","min-width":"200",prop:"detail"}),l(w,{label:"时间",width:"100"},{default:a(({row:o})=>[_(n(G(o.timestamp)),1)]),_:1})]),_:1},8,["data"]),h.value.total>R.value.length?(u(),c("div",Pt,[e("span",null,"显示前 "+n(R.value.length)+" 条，共 "+n(h.value.total)+" 条",1),l(y,{text:"",type:"primary",onClick:Q},{default:a(()=>[...s[52]||(s[52]=[_("查看全部并下载",-1)])]),_:1})])):f("",!0)])):h.value.total===0?(u(),c("div",Ot,[l(d,null,{default:a(()=>[l(Qs)]),_:1}),s[53]||(s[53]=e("span",null,"暂无异常Key",-1))])):f("",!0)])):f("",!0),e("div",jt,[e("div",Mt,[e("h3",null,[l(d,null,{default:a(()=>[l(Gs)]),_:1}),s[54]||(s[54]=_(" 任务日志",-1))]),e("div",Yt,[l(ts,{modelValue:B.value,"onUpdate:modelValue":s[2]||(s[2]=o=>B.value=o),placeholder:"日志级别",size:"small",style:{width:"100px"},clearable:""},{default:a(()=>[l(T,{label:"DEBUG",value:"DEBUG"}),l(T,{label:"INFO",value:"INFO"}),l(T,{label:"WARN",value:"WARN"}),l(T,{label:"ERROR",value:"ERROR"})]),_:1},8,["modelValue"]),l(y,{size:"small",onClick:I},{default:a(()=>[l(d,null,{default:a(()=>[l(ls)]),_:1}),s[55]||(s[55]=_(" 刷新 ",-1))]),_:1})])]),e("div",{class:"logs-container",ref_key:"logsContainer",ref:xs},[E.value.length===0?(u(),c("div",$t," 暂无日志 ")):f("",!0),(u(!0),c(q,null,W(E.value,o=>{var K,ws;return u(),c("div",{key:o.id,class:S(["log-entry",(K=o.level)==null?void 0:K.toLowerCase()])},[e("span",Wt,n(G(o.timestamp)),1),e("span",{class:S(["log-level",(ws=o.level)==null?void 0:ws.toLowerCase()])},n(o.level),3),e("span",Ht,n(o.message),1),o.fields?(u(),c("span",At,n(Ss(o.fields)),1)):f("",!0)],2)}),128))],512)])])):(u(),c("div",Jt,[l(d,{class:"loading-icon"},{default:a(()=>[l(Xs)]),_:1}),s[56]||(s[56]=e("span",null,"加载中...",-1))])),l(ee,{modelValue:F.value,"onUpdate:modelValue":s[8]||(s[8]=o=>F.value=o),title:"调整运行参数",width:"500px"},{footer:a(()=>[l(y,{onClick:s[7]||(s[7]=o=>F.value=!1)},{default:a(()=>[...s[62]||(s[62]=[_("取消",-1)])]),_:1}),l(y,{type:"primary",onClick:Ns,loading:M.value},{default:a(()=>[...s[63]||(s[63]=[_(" 应用参数 ",-1)])]),_:1},8,["loading"])]),default:a(()=>[l(Zs,{type:"warning",closable:!1,style:{"margin-bottom":"20px"}},{title:a(()=>[...s[57]||(s[57]=[e("strong",null,"优雅调整说明",-1)])]),default:a(()=>[s[58]||(s[58]=_(" 参数调整将在当前批次完成后生效，确保正在迁移的数据完整性。调整期间任务会短暂暂停。 ",-1))]),_:1}),l(se,{model:p,"label-width":"120px"},{default:a(()=>[l(P,{label:"Worker数量"},{default:a(()=>[l(N,{modelValue:p.worker_count,"onUpdate:modelValue":s[3]||(s[3]=o=>p.worker_count=o),min:1,max:100,style:{width:"100%"}},null,8,["modelValue"]),s[59]||(s[59]=e("div",{class:"form-tip"},"增加Worker可提高速度，但会增加源端负载",-1))]),_:1}),l(P,{label:"扫描批次大小"},{default:a(()=>[l(N,{modelValue:p.scan_batch_size,"onUpdate:modelValue":s[4]||(s[4]=o=>p.scan_batch_size=o),min:100,max:1e4,step:100,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),l(P,{label:"源端QPS限制"},{default:a(()=>[l(N,{modelValue:p.source_qps,"onUpdate:modelValue":s[5]||(s[5]=o=>p.source_qps=o),min:0,max:1e5,step:1e3,style:{width:"100%"}},null,8,["modelValue"]),s[60]||(s[60]=e("div",{class:"form-tip"},"0 表示不限制",-1))]),_:1}),l(P,{label:"目标端QPS限制"},{default:a(()=>[l(N,{modelValue:p.target_qps,"onUpdate:modelValue":s[6]||(s[6]=o=>p.target_qps=o),min:0,max:1e5,step:1e3,style:{width:"100%"}},null,8,["modelValue"]),s[61]||(s[61]=e("div",{class:"form-tip"},"0 表示不限制",-1))]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])],64)}}},Zt=te(Qt,[["__scopeId","data-v-48332d2d"]]);export{Zt as default};
